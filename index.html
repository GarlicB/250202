<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WaveAttack MAX - 업그레이드 버전</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div id="introControls">
      <button id="startGame" class="game-button">게임 시작</button>
    </div>
    <canvas id="gameCanvas"></canvas>
    <!-- 옵션(디버그) 모달 -->
    <div id="optionsModal" class="modal">
      <div class="modal-header">
        <h2>🛠️ 디버그 콘솔</h2>
        <button id="closeOptions" class="close-btn">×</button>
      </div>

      <div class="modal-content">
        <div class="debug-section">
          <div class="section-header">
            <span class="section-icon">🎨</span>
            <h3>시각 효과</h3>
          </div>
          <div class="section-content">
            <div class="input-group">
              <label>배경 색상:</label>
              <input type="color" id="bgColorPicker" value="#111111" />
              <button id="applyBgColor" class="action-btn">적용</button>
            </div>
          </div>
        </div>

        <div class="debug-section">
          <div class="section-header">
            <span class="section-icon">🎯</span>
            <h3>전투 테스트</h3>
          </div>
          <div class="section-content">
            <div class="input-group">
              <label>총알 테스트:</label>
              <button id="spawnTestBullet" class="action-btn">총알 발사</button>
            </div>
            <div class="input-group">
              <label>몹 테스트:</label>
              <button id="spawnTestEnemy" class="action-btn">몹 소환</button>
            </div>
          </div>
        </div>

        <div class="debug-section">
          <div class="section-header">
            <span class="section-icon">⚡</span>
            <h3>스킬 활성화</h3>
          </div>
          <div class="section-content">
            <div class="input-group">
              <label>쿨타임 제거:</label>
              <input type="checkbox" id="removeSkillCooldown" checked />
            </div>
            <div class="input-group">
              <label>기본 총알 제거:</label>
              <input type="checkbox" id="removeBasicBullet" />
            </div>
            <div class="skill-grid">
              <div class="skill-item">
                <input
                  type="checkbox"
                  id="skill_regenAura"
                  data-skill="regenAura"
                  checked
                />
                <label for="skill_regenAura">
                  <span class="skill-icon">💚</span>
                  회복 오라
                  <span class="key-hint">Q</span>
                </label>
              </div>
              <div class="skill-item">
                <input
                  type="checkbox"
                  id="skill_homingLaser"
                  data-skill="homingLaser"
                  checked
                />
                <label for="skill_homingLaser">
                  <span class="skill-icon">🎯</span>
                  레이저 빔
                  <span class="key-hint">W</span>
                </label>
              </div>
              <div class="skill-item">
                <input
                  type="checkbox"
                  id="skill_chainLightning"
                  data-skill="chainLightning"
                  checked
                />
                <label for="skill_chainLightning">
                  <span class="skill-icon">⚡</span>
                  연쇄 번개
                  <span class="key-hint">E</span>
                </label>
              </div>
              <div class="skill-item">
                <input
                  type="checkbox"
                  id="skill_meteorShower"
                  data-skill="meteorShower"
                  checked
                />
                <label for="skill_meteorShower">
                  <span class="skill-icon">☄️</span>
                  메테오
                  <span class="key-hint">R</span>
                </label>
              </div>
            </div>
          </div>
        </div>

        <div class="debug-section">
          <div class="section-header">
            <span class="section-icon">📊</span>
            <h3>게임 진행</h3>
          </div>
          <div class="section-content">
            <div class="input-group">
              <label>레벨업 테스트:</label>
              <button id="simulateLevelUp" class="action-btn">레벨업</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <button id="debugButton">
      <span class="debug-icon">🛠️</span>
      디버그
    </button>

    <!-- 모바일 컨트롤 UI -->
    <div id="mobileControls">
      <!-- 레이저 스킬 버튼 -->
      <button id="laserSkillBtn" class="skill-button">
        <span class="skill-icon">🎯</span>
        레이저
        <div class="charge-bar"></div>
      </button>

      <!-- 가상 조이스틱 -->
      <div id="joystickArea">
        <div id="joystickBase"></div>
        <div id="joystickHandle"></div>
      </div>
    </div>

    <style>
      /* 게임 시작 버튼 스타일 수정 */
      #introControls {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        z-index: 2000; /* 조이스틱보다 위에 표시 */
        pointer-events: auto;
      }

      .game-button {
        background: rgba(0, 0, 0, 0.8);
        color: #ffd700;
        border: 2px solid #ffd700;
        padding: 15px 30px;
        font-size: 24px;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.3s;
        pointer-events: auto;
      }

      .game-button:hover {
        background: rgba(255, 215, 0, 0.2);
      }

      /* 조이스틱 영역 수정 */
      #joystickArea {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 70%;
        background: transparent;
        touch-action: none;
        z-index: 1000;
        display: none; /* 게임 시작 전에는 숨김 */
      }

      #mobileControls {
        position: fixed;
        z-index: 1000;
        display: none;
        pointer-events: none;
      }

      @media (max-width: 768px) {
        #mobileControls {
          display: block;
        }

        #joystickArea {
          display: block; /* 모바일에서만 표시 */
        }

        .game-button {
          font-size: 20px;
          padding: 12px 24px;
        }
      }

      /* 스킬 버튼 스타일 */
      .skill-button {
        position: fixed;
        top: 20px;
        right: 20px;
        background: rgba(0, 0, 0, 0.6);
        border: 2px solid #ffd700;
        color: #ffd700;
        padding: 15px 25px;
        border-radius: 25px;
        font-size: 20px;
        display: flex;
        align-items: center;
        gap: 8px;
        cursor: pointer;
        transition: all 0.3s;
        pointer-events: auto; /* 버튼은 터치 가능 */
      }

      /* 조이스틱 스타일 */
      #joystickBase {
        position: fixed;
        width: 100px;
        height: 100px;
        background: rgba(255, 255, 255, 0.15);
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        transform: translate(-50%, -50%);
        pointer-events: none;
        backdrop-filter: blur(5px);
        display: none;
      }

      #joystickHandle {
        position: fixed;
        width: 50px;
        height: 50px;
        background: rgba(255, 255, 255, 0.4);
        border: 2px solid rgba(255, 255, 255, 0.6);
        border-radius: 50%;
        transform: translate(-50%, -50%);
        pointer-events: none;
        backdrop-filter: blur(5px);
        display: none;
      }

      /* 모바일 스킬 선택 UI */
      .mobile-skill-select {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(0, 0, 0, 0.9);
        padding: 20px;
        border-radius: 15px;
        width: 80%;
        max-width: 400px;
        z-index: 1000;
      }

      .mobile-skill-option {
        background: rgba(255, 255, 255, 0.1);
        padding: 15px;
        margin: 10px 0;
        border-radius: 10px;
        color: white;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 10px;
      }

      .mobile-skill-option .skill-icon {
        font-size: 24px;
      }

      .mobile-skill-option .skill-name {
        font-size: 18px;
        font-weight: bold;
      }

      .mobile-skill-option .skill-description {
        font-size: 14px;
        opacity: 0.8;
        margin: 0;
      }

      .mobile-skill-option:active {
        background: rgba(255, 215, 0, 0.3);
      }

      /* 모바일 상점 UI */
      .mobile-shop {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(0, 0, 0, 0.9);
        padding: 20px;
        border-radius: 15px;
        width: 80%;
        max-width: 400px;
        z-index: 1000;
      }

      .mobile-shop-item {
        background: rgba(255, 255, 255, 0.1);
        padding: 15px;
        margin: 10px 0;
        border-radius: 10px;
        color: white;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .mobile-shop-item .item-icon {
        font-size: 24px;
      }

      .mobile-shop-item .item-name {
        flex: 1;
        margin: 0 15px;
        font-size: 16px;
      }

      .mobile-shop-item .item-cost {
        color: #ffd700;
        font-weight: bold;
      }

      .mobile-shop-item:active {
        background: rgba(255, 215, 0, 0.3);
      }

      .mobile-shop-close {
        width: 100%;
        padding: 15px;
        margin-top: 20px;
        background: rgba(255, 255, 255, 0.2);
        border: none;
        border-radius: 10px;
        color: white;
        font-size: 16px;
        cursor: pointer;
      }

      .mobile-shop-close:active {
        background: rgba(255, 255, 255, 0.3);
      }

      /* 차지 바 스타일 개선 */
      .charge-bar {
        position: absolute;
        bottom: 0;
        left: 0;
        height: 4px;
        width: 0%;
        background: linear-gradient(to right, #ffd700, #ff6b6b);
        border-radius: 2px;
        transition: width 0.1s linear;
      }

      .skill-button.charging {
        background: rgba(255, 215, 0, 0.2);
      }
    </style>

    <script type="module">
      import { Game } from "./js/core/Game.js";
      const game = new Game();
    </script>
  </body>
</html>
